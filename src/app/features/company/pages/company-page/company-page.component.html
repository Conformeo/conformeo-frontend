<h1 class="text-2xl font-semibold mb-6">Sécurité & certifications</h1>

<div class="grid md:grid-cols-2 gap-10">

  <!-- ========================================================= Extincteurs -->
  <section>
    <div class="flex items-center justify-between mb-2">
      <h2 class="font-medium">Extincteurs</h2>
      <button class="btn-primary" (click)="openExtForm()"> Ajouter</button>
    </div>

    <!-- liste -->
    <ng-container *ngIf="exts$ | async as exts; else extSkel">
      <app-extinguisher-table [data]="exts"
                              (edit)="openExtForm($event)"></app-extinguisher-table>
    </ng-container>
    <ng-template #extSkel>
      <app-skeleton height="8rem"></app-skeleton>
    </ng-template>
  </section>

  <!-- ====================================================== Certifications -->
  <section>
    <div class="flex items-center justify-between mb-2">
      <h2 class="font-medium">Certifications</h2>
      <button class="btn-primary" (click)="openCertForm()"> Ajouter</button>
    </div>

    <ng-container *ngIf="certs$ | async as certs; else certSkel">
      <app-certification-table [data]="certs"
                               (edit)="openCertForm($event)"></app-certification-table>
    </ng-container>
    <ng-template #certSkel>
      <app-skeleton height="8rem"></app-skeleton>
    </ng-template>
  </section>

  <!-- ========================================================= Caméras -->
  <section>
    <div class="flex items-center justify-between mb-2">
      <h2 class="font-medium">Caméras</h2>
      <button class="btn-primary" (click)="openCameraForm()"> Ajouter</button>
    </div>
    <ng-container *ngIf="cameras$ | async as cams; else camSkel">
      <app-camera-table [data]="cams"
                        (edit)="openCameraForm($event)"></app-camera-table>
    </ng-container>
    <ng-template #camSkel><app-skeleton height="8rem"></app-skeleton></ng-template>
  </section>

  <!-- =============================================== Trousse & DEA -->
  <section>
    <div class="flex items-center justify-between mb-2">
      <h2 class="font-medium">Trousse de secours & DEA</h2>
      <button class="btn-primary" (click)="openKitForm()"> Ajouter</button>
    </div>
    <ng-container *ngIf="kits$ | async as kits; else kitSkel">
      <app-kit-table [data]="kits"
                     (edit)="openKitForm($event)"></app-kit-table>
    </ng-container>
    <ng-template #kitSkel><app-skeleton height="8rem"></app-skeleton></ng-template>
  </section>

  <!-- ========================================== Assurances & légales -->
  <section>
    <div class="flex items-center justify-between mb-2">
      <h2 class="font-medium">Assurances & légales</h2>
      <button class="btn-primary" (click)="openInsuranceForm()"> Ajouter</button>
    </div>
    <ng-container *ngIf="insurances$ | async as ins; else insSkel">
      <app-insurance-table [data]="ins"
                            (edit)="openInsuranceForm($event)"></app-insurance-table>
    </ng-container>
    <ng-template #insSkel><app-skeleton height="8rem"></app-skeleton></ng-template>
  </section>
</div>

<!-- -------------------------- Modaux ------------------------- -->
<app-modal *ngIf="editingExt"
           title="Extincteur"
           (closed)="closeExtForm()">
  <app-extinguisher-form
        [extinguisher]="editingExt"
        (saved)="onSaved(); closeExtForm()">
  </app-extinguisher-form>
</app-modal>

<app-modal *ngIf="editingCert"
           title="Certification"
           (closed)="closeCertForm()">
  <app-certification-form
        [certification]="editingCert"
        (saved)="onSaved(); closeCertForm()">
  </app-certification-form>
</app-modal>

<app-modal *ngIf="editingCam"
           title="Caméra"
           (closed)="closeCameraForm()">
  <app-camera-form
        [camera]="editingCam"
        (saved)="onSaved(); closeCameraForm()">
  </app-camera-form>
</app-modal>

<app-modal *ngIf="editingKit"
           title="Trousse de secours"
           (closed)="closeKitForm()">
  <app-kit-form
        [kit]="editingKit"
        (saved)="onSaved(); closeKitForm()">
  </app-kit-form>
</app-modal>

<app-modal *ngIf="editingIns"
           title="Assurance"
           (closed)="closeInsuranceForm()">
  <app-insurance-form
        [insurance]="editingIns"
        (saved)="onSaved(); closeInsuranceForm()">
  </app-insurance-form>
</app-modal>